@using CardOverflow.Entity
@using CardOverflow.Debug
@using CardOverflow.Api
@using CardOverflow.Pure
@inherits LayoutComponentBase
@inject AuthenticationStateProvider AuthenticationStateProvider
@inject CardOverflowDb Db

<CascadingValue Value="@User">
  <div class="sidebar">
    <NavMenu />
  </div>

  <div class="main">
    @* Keep this div to make the Study page look ok. *@
    <div class="content px-4">
      @Body
    </div>
  </div>
</CascadingValue>

@code {
  UserEntity User;

  protected override async Task OnInitializedAsync() {
    var email =
      (await AuthenticationStateProvider.GetAuthenticationStateAsync())
      .User.Identity.Name;
    User = UserRepository.Get(Db, email);
  }

}
